Namespace(adam_beta1=0.9, adam_beta2=0.999, attention_map=False, attention_probs_dropout_prob=0.5, attention_type='Cluster', augment_type='mask', batch_size=256, beta=0.2, cf_weight=0.1, checkpoint_path='output_custom/Beauty/Cluster_Attention_IntentCL/UPTRec-Beauty-UPTRec_Clustered_Attention_IntentCL_mask_0.7_test-16-256.pt', context='item_embedding', contrast_type='IntentCL', cuda_condition=True, data_dir='data/', data_file='data/Beauty.txt', data_name='Beauty', de_noise=False, device='cuda:1', do_eval=False, embedding=False, epochs=1000, gamma=0.7, gpu_id='0', hidden_act='gelu', hidden_dropout_prob=0.5, hidden_size=64, initializer_range=0.02, intent_cf_weight=0.3, item_size=12103, log_file='output_custom/Beauty/Cluster_Attention_IntentCL/UPTRec-Beauty-UPTRec_Clustered_Attention_IntentCL_mask_0.7_test-16-256.txt', log_freq=1, lr=0.001, mask_id=12102, max_seq_length=50, model_idx='UPTRec_Clustered_Attention_IntentCL_mask_0.7_test', model_name='UPTRec', n_views=3, no_cuda=False, noise_ratio=0.0, num_attention_heads=2, num_hidden_layers=2, num_intent_clusters='16', output_dir='output_custom/Beauty/Cluster_Attention_IntentCL', patience=500, rec_weight=1.0, save_pt='False', seed=1, seq_representation_instancecl_type='concatenate', seq_representation_type='concatenate', tao=0.2, temperature=0.5, train_matrix=<22363x12103 sparse matrix of type '<class 'numpy.int64'>'
	with 153776 stored elements in Compressed Sparse Row format>, training_data_ratio=1.0, warm_up_epoches=100.0, weight_decay=0.0)
{'epoch': 0, 'rec_avg_loss': '0.0798832', 'joint_avg_loss': '0.079883'}
{'epoch': 0, 'rec_avg_loss': '0.161168', 'joint_avg_loss': '0.161168'}
{'epoch': 0, 'rec_avg_loss': '0.242128', 'joint_avg_loss': '0.242128'}
{'epoch': 0, 'rec_avg_loss': '0.324875', 'joint_avg_loss': '0.324875'}
{'epoch': 0, 'rec_avg_loss': '0.403341', 'joint_avg_loss': '0.403341'}
{'epoch': 0, 'rec_avg_loss': '0.487488', 'joint_avg_loss': '0.487488'}
{'epoch': 0, 'rec_avg_loss': '0.564443', 'joint_avg_loss': '0.564443'}
{'epoch': 0, 'rec_avg_loss': '0.647289', 'joint_avg_loss': '0.647289'}
{'epoch': 0, 'rec_avg_loss': '0.729595', 'joint_avg_loss': '0.729595'}
{'epoch': 0, 'rec_avg_loss': '0.807989', 'joint_avg_loss': '0.807989'}
{'epoch': 0, 'rec_avg_loss': '0.889175', 'joint_avg_loss': '0.889175'}
{'epoch': 0, 'rec_avg_loss': '0.971464', 'joint_avg_loss': '0.971464'}
{'epoch': 0, 'rec_avg_loss': '1.04553', 'joint_avg_loss': '1.045532'}
{'epoch': 0, 'rec_avg_loss': '1.12618', 'joint_avg_loss': '1.126176'}
{'epoch': 0, 'rec_avg_loss': '1.20394', 'joint_avg_loss': '1.203935'}
{'epoch': 0, 'rec_avg_loss': '1.28078', 'joint_avg_loss': '1.280776'}
{'epoch': 0, 'rec_avg_loss': '1.36398', 'joint_avg_loss': '1.363978'}
{'epoch': 0, 'rec_avg_loss': '1.44788', 'joint_avg_loss': '1.447878'}
{'epoch': 0, 'rec_avg_loss': '1.52851', 'joint_avg_loss': '1.528514'}
{'epoch': 0, 'rec_avg_loss': '1.60887', 'joint_avg_loss': '1.608874'}
{'epoch': 0, 'rec_avg_loss': '1.69107', 'joint_avg_loss': '1.691066'}
{'epoch': 0, 'rec_avg_loss': '1.76555', 'joint_avg_loss': '1.765554'}
{'epoch': 0, 'rec_avg_loss': '1.84105', 'joint_avg_loss': '1.841048'}
{'epoch': 0, 'rec_avg_loss': '1.92245', 'joint_avg_loss': '1.922454'}
{'epoch': 0, 'rec_avg_loss': '2.00471', 'joint_avg_loss': '2.004709'}
{'epoch': 0, 'rec_avg_loss': '2.0814', 'joint_avg_loss': '2.081402'}
{'epoch': 0, 'rec_avg_loss': '2.16245', 'joint_avg_loss': '2.162447'}
{'epoch': 0, 'rec_avg_loss': '2.24535', 'joint_avg_loss': '2.245349'}
{'epoch': 0, 'rec_avg_loss': '2.32626', 'joint_avg_loss': '2.326261'}
{'epoch': 0, 'rec_avg_loss': '2.40125', 'joint_avg_loss': '2.401252'}
{'epoch': 0, 'rec_avg_loss': '2.48134', 'joint_avg_loss': '2.481340'}
{'epoch': 0, 'rec_avg_loss': '2.55949', 'joint_avg_loss': '2.559489'}
{'epoch': 0, 'rec_avg_loss': '2.6411', 'joint_avg_loss': '2.641097'}
{'epoch': 0, 'rec_avg_loss': '2.72437', 'joint_avg_loss': '2.724366'}
{'epoch': 0, 'rec_avg_loss': '2.79928', 'joint_avg_loss': '2.799282'}
{'epoch': 0, 'rec_avg_loss': '2.8759', 'joint_avg_loss': '2.875900'}
{'epoch': 0, 'rec_avg_loss': '2.9537', 'joint_avg_loss': '2.953697'}
{'epoch': 0, 'rec_avg_loss': '3.02901', 'joint_avg_loss': '3.029009'}
{'epoch': 0, 'rec_avg_loss': '3.10505', 'joint_avg_loss': '3.105053'}
{'epoch': 0, 'rec_avg_loss': '3.1794', 'joint_avg_loss': '3.179396'}
{'epoch': 0, 'rec_avg_loss': '3.25987', 'joint_avg_loss': '3.259874'}
{'epoch': 0, 'rec_avg_loss': '3.33471', 'joint_avg_loss': '3.334712'}
{'epoch': 0, 'rec_avg_loss': '3.40833', 'joint_avg_loss': '3.408326'}
{'epoch': 0, 'rec_avg_loss': '3.48505', 'joint_avg_loss': '3.485048'}
{'epoch': 0, 'rec_avg_loss': '3.5627', 'joint_avg_loss': '3.562703'}
{'epoch': 0, 'rec_avg_loss': '3.63431', 'joint_avg_loss': '3.634306'}
{'epoch': 0, 'rec_avg_loss': '3.71162', 'joint_avg_loss': '3.711625'}
{'epoch': 0, 'rec_avg_loss': '3.78387', 'joint_avg_loss': '3.783874'}
{'epoch': 0, 'rec_avg_loss': '3.85586', 'joint_avg_loss': '3.855856'}
{'epoch': 0, 'rec_avg_loss': '3.93068', 'joint_avg_loss': '3.930675'}
{'epoch': 0, 'rec_avg_loss': '4.00237', 'joint_avg_loss': '4.002366'}
{'epoch': 0, 'rec_avg_loss': '4.07448', 'joint_avg_loss': '4.074475'}
{'epoch': 0, 'rec_avg_loss': '4.14621', 'joint_avg_loss': '4.146208'}
{'epoch': 0, 'rec_avg_loss': '4.21588', 'joint_avg_loss': '4.215882'}
{'epoch': 0, 'rec_avg_loss': '4.28976', 'joint_avg_loss': '4.289762'}
{'epoch': 0, 'rec_avg_loss': '4.36323', 'joint_avg_loss': '4.363227'}
{'epoch': 0, 'rec_avg_loss': '4.43525', 'joint_avg_loss': '4.435254'}
{'epoch': 0, 'rec_avg_loss': '4.50665', 'joint_avg_loss': '4.506650'}
{'epoch': 0, 'rec_avg_loss': '4.58171', 'joint_avg_loss': '4.581713'}
{'epoch': 0, 'rec_avg_loss': '4.65311', 'joint_avg_loss': '4.653110'}
{'epoch': 0, 'rec_avg_loss': '4.72393', 'joint_avg_loss': '4.723928'}
{'epoch': 0, 'rec_avg_loss': '4.79695', 'joint_avg_loss': '4.796953'}
{'epoch': 0, 'rec_avg_loss': '4.86257', 'joint_avg_loss': '4.862572'}
{'epoch': 0, 'rec_avg_loss': '4.93365', 'joint_avg_loss': '4.933649'}
{'epoch': 0, 'rec_avg_loss': '5.00359', 'joint_avg_loss': '5.003585'}
{'epoch': 0, 'rec_avg_loss': '5.07591', 'joint_avg_loss': '5.075914'}
{'epoch': 0, 'rec_avg_loss': '5.14972', 'joint_avg_loss': '5.149724'}
{'epoch': 0, 'rec_avg_loss': '5.21835', 'joint_avg_loss': '5.218352'}
{'epoch': 0, 'rec_avg_loss': '5.28755', 'joint_avg_loss': '5.287546'}
{'epoch': 0, 'rec_avg_loss': '5.35836', 'joint_avg_loss': '5.358364'}
{'epoch': 0, 'rec_avg_loss': '5.42991', 'joint_avg_loss': '5.429905'}
{'epoch': 0, 'rec_avg_loss': '5.50205', 'joint_avg_loss': '5.502050'}
{'epoch': 0, 'rec_avg_loss': '5.56968', 'joint_avg_loss': '5.569685'}
{'epoch': 0, 'rec_avg_loss': '5.63691', 'joint_avg_loss': '5.636908'}
{'epoch': 0, 'rec_avg_loss': '5.7066', 'joint_avg_loss': '5.706596'}
{'epoch': 0, 'rec_avg_loss': '5.77608', 'joint_avg_loss': '5.776079'}
{'epoch': 0, 'rec_avg_loss': '5.84516', 'joint_avg_loss': '5.845156'}
{'epoch': 0, 'rec_avg_loss': '5.91532', 'joint_avg_loss': '5.915325'}
{'epoch': 0, 'rec_avg_loss': '5.98228', 'joint_avg_loss': '5.982278'}
{'epoch': 0, 'rec_avg_loss': '6.04923', 'joint_avg_loss': '6.049230'}
{'epoch': 0, 'rec_avg_loss': '6.11511', 'joint_avg_loss': '6.115112'}
{'epoch': 0, 'rec_avg_loss': '6.18086', 'joint_avg_loss': '6.180857'}
{'epoch': 0, 'rec_avg_loss': '6.2487', 'joint_avg_loss': '6.248698'}
{'epoch': 0, 'rec_avg_loss': '6.31206', 'joint_avg_loss': '6.312060'}
{'epoch': 0, 'rec_avg_loss': '6.37947', 'joint_avg_loss': '6.379471'}
{'epoch': 0, 'rec_avg_loss': '6.44734', 'joint_avg_loss': '6.447344'}
{'epoch': 0, 'rec_avg_loss': '6.51309', 'joint_avg_loss': '6.513095'}
Namespace(adam_beta1=0.9, adam_beta2=0.999, attention_map=False, attention_probs_dropout_prob=0.5, attention_type='Cluster', augment_type='mask', batch_size=256, beta=0.2, cf_weight=0.1, checkpoint_path='output_custom/Beauty/Cluster_Attention_IntentCL/UPTRec-Beauty-UPTRec_Clustered_Attention_IntentCL_mask_0.7_test-16-256.pt', context='item_embedding', contrast_type='IntentCL', cuda_condition=True, data_dir='data/', data_file='data/Beauty.txt', data_name='Beauty', de_noise=False, device='cuda:1', do_eval=False, embedding=False, epochs=1000, gamma=0.7, gpu_id='0', hidden_act='gelu', hidden_dropout_prob=0.5, hidden_size=64, initializer_range=0.02, intent_cf_weight=0.3, item_size=12103, log_file='output_custom/Beauty/Cluster_Attention_IntentCL/UPTRec-Beauty-UPTRec_Clustered_Attention_IntentCL_mask_0.7_test-16-256.txt', log_freq=1, lr=0.001, mask_id=12102, max_seq_length=50, model_idx='UPTRec_Clustered_Attention_IntentCL_mask_0.7_test', model_name='UPTRec', n_views=3, no_cuda=False, noise_ratio=0.0, num_attention_heads=2, num_hidden_layers=2, num_intent_clusters='16', output_dir='output_custom/Beauty/Cluster_Attention_IntentCL', patience=500, rec_weight=1.0, save_pt='False', seed=1, seq_representation_instancecl_type='concatenate', seq_representation_type='concatenate', tao=0.2, temperature=0.5, train_matrix=<22363x12103 sparse matrix of type '<class 'numpy.int64'>'
	with 153776 stored elements in Compressed Sparse Row format>, training_data_ratio=1.0, warm_up_epoches=100.0, weight_decay=0.0)
{'epoch': 0, 'rec_avg_loss': '6.51309', 'joint_avg_loss': '6.513095'}
Namespace(adam_beta1=0.9, adam_beta2=0.999, attention_map=False, attention_probs_dropout_prob=0.5, attention_type='Cluster', augment_type='mask', batch_size=256, beta=0.2, cf_weight=0.1, checkpoint_path='output_custom/Beauty/Cluster_Attention_IntentCL/UPTRec-Beauty-UPTRec_Clustered_Attention_IntentCL_mask_0.7_test-16-256.pt', context='item_embedding', contrast_type='IntentCL', cuda_condition=True, data_dir='data/', data_file='data/Beauty.txt', data_name='Beauty', de_noise=False, device='cuda:1', do_eval=False, embedding=False, epochs=1000, gamma=0.7, gpu_id='0', hidden_act='gelu', hidden_dropout_prob=0.5, hidden_size=64, initializer_range=0.02, intent_cf_weight=0.3, item_size=12103, log_file='output_custom/Beauty/Cluster_Attention_IntentCL/UPTRec-Beauty-UPTRec_Clustered_Attention_IntentCL_mask_0.7_test-16-256.txt', log_freq=1, lr=0.001, mask_id=12102, max_seq_length=50, model_idx='UPTRec_Clustered_Attention_IntentCL_mask_0.7_test', model_name='UPTRec', n_views=3, no_cuda=False, noise_ratio=0.0, num_attention_heads=2, num_hidden_layers=2, num_intent_clusters='16', output_dir='output_custom/Beauty/Cluster_Attention_IntentCL', patience=500, rec_weight=1.0, save_pt='False', seed=1, seq_representation_instancecl_type='concatenate', seq_representation_type='concatenate', tao=0.2, temperature=0.5, train_matrix=<22363x12103 sparse matrix of type '<class 'numpy.int64'>'
	with 153776 stored elements in Compressed Sparse Row format>, training_data_ratio=1.0, warm_up_epoches=100.0, weight_decay=0.0)
{'epoch': 0, 'rec_avg_loss': '6.51309', 'joint_avg_loss': '6.513095'}
{'Epoch': 0, 'HIT@5': '0.000584', 'NDCG@5': '0.000320', 'HIT@10': '0.001078', 'NDCG@10': '0.000481', 'HIT@15': '0.001302', 'NDCG@15': '0.000542', 'HIT@20': '0.001931', 'NDCG@20': '0.000692'}
{'epoch': 1, 'rec_avg_loss': '4.88494', 'joint_avg_loss': '4.884940'}
{'Epoch': 1, 'HIT@5': '0.000629', 'NDCG@5': '0.000467', 'HIT@10': '0.001257', 'NDCG@10': '0.000668', 'HIT@15': '0.001931', 'NDCG@15': '0.000845', 'HIT@20': '0.002380', 'NDCG@20': '0.000951'}
------------------------------ Continue Training ------------------------------ 
{'epoch': 0, 'rec_avg_loss': '5.31727', 'joint_avg_loss': '180.040821'}
{'Epoch': 0, 'HIT@5': '0.000269', 'NDCG@5': '0.000127', 'HIT@10': '0.000943', 'NDCG@10': '0.000333', 'HIT@15': '0.001212', 'NDCG@15': '0.000407', 'HIT@20': '0.001661', 'NDCG@20': '0.000513'}
