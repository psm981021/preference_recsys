Train UPTRec
[Train] Preparing Clustering:
 88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                      | 38/43 [00:01<00:00, 18.01it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:02<00:00, 21.49it/s]
  0%|                                                                                                                                                                                                        | 0/1 [00:00<?, ?it/s]
Model Training
rec dataset length: 43
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:04<00:00,  4.89s/it]





 88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                      | 38/43 [00:10<00:01,  3.54it/s]
{'epoch': 0, 'rec_avg_loss': '6.79873', 'joint_avg_loss': '0.000000', 'Align_loss': '0.000000', 'NMI_cluster_reassignment': '0.000000'}
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:11<00:00,  3.59it/s]
 42%|███████████████████████████████████████████████████████████████████████████████▌                                                                                                              | 18/43 [00:00<00:01, 22.59it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:02<00:00, 21.02it/s]
  0%|                                                                                                                                                                                                        | 0/1 [00:00<?, ?it/s]

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:04<00:00,  4.76s/it]



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:07<00:00,  5.47it/s]
{'Epoch': 0, 'HIT@5': '0.000454', 'NDCG@5': '0.000276', 'HIT@10': '0.000908', 'NDCG@10': '0.000420', 'HIT@15': '0.001226', 'NDCG@15': '0.000504', 'HIT@20': '0.001635', 'NDCG@20': '0.000600'}
Validation score increased.  Saving model ...
Model Training
rec dataset length: 43
Performing Rec model Training (UPTRec):




 93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋             | 40/43 [00:09<00:00,  3.86it/s]
{'epoch': 1, 'rec_avg_loss': '5.74923', 'joint_avg_loss': '0.000000', 'Align_loss': '0.000000', 'NMI_cluster_reassignment': '0.000000'}
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:10<00:00,  4.10it/s]
  0%|                                                                                                                                                                                                       | 0/43 [00:00<?, ?it/s]




100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:07<00:00,  5.45it/s]
{'Epoch': 1, 'HIT@5': '0.000273', 'NDCG@5': '0.000134', 'HIT@10': '0.000818', 'NDCG@10': '0.000301', 'HIT@15': '0.001408', 'NDCG@15': '0.000458', 'HIT@20': '0.001681', 'NDCG@20': '0.000523'}
EarlyStopping counter: 1 out of 500
Model Training
rec dataset length: 43
  0%|                                                                                                                                                                                                       | 0/43 [00:10<?, ?it/s]




100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:11<00:00,  3.83it/s]
  0%|                                                                                                                                                                                                       | 0/43 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                                       | 0/43 [00:00<?, ?it/s]
{'epoch': 2, 'rec_avg_loss': '4.78868', 'joint_avg_loss': '0.000000', 'Align_loss': '0.000000', 'NMI_cluster_reassignment': '0.000000'}




100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:07<00:00,  5.45it/s]
{'Epoch': 2, 'HIT@5': '0.000273', 'NDCG@5': '0.000123', 'HIT@10': '0.001136', 'NDCG@10': '0.000398', 'HIT@15': '0.001590', 'NDCG@15': '0.000519', 'HIT@20': '0.001953', 'NDCG@20': '0.000605'}
Validation score increased.  Saving model ...
Model Training
rec dataset length: 43
  0%|                                                                                                                                                                                                       | 0/43 [00:10<?, ?it/s]




 86%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                          | 37/43 [00:09<00:01,  3.86it/s]
{'epoch': 3, 'rec_avg_loss': '4.06175', 'joint_avg_loss': '0.000000', 'Align_loss': '0.000000', 'NMI_cluster_reassignment': '0.000000'}
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:11<00:00,  3.84it/s]
  0%|                                                                                                                                                                                                       | 0/43 [00:00<?, ?it/s]




100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:07<00:00,  5.45it/s]
{'Epoch': 3, 'HIT@5': '0.000045', 'NDCG@5': '0.000023', 'HIT@10': '0.001226', 'NDCG@10': '0.000405', 'HIT@15': '0.001862', 'NDCG@15': '0.000573', 'HIT@20': '0.002226', 'NDCG@20': '0.000659'}
Validation score increased.  Saving model ...
Model Training
rec dataset length: 43
  0%|                                                                                                                                                                                                       | 0/43 [00:10<?, ?it/s]





 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                 | 39/43 [00:10<00:01,  3.64it/s]
{'epoch': 4, 'rec_avg_loss': '3.50733', 'joint_avg_loss': '0.000000', 'Align_loss': '0.000000', 'NMI_cluster_reassignment': '0.000000'}
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:11<00:00,  3.77it/s]
  0%|                                                                                                                                                                                                       | 0/43 [00:00<?, ?it/s]




100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:07<00:00,  5.42it/s]
{'Epoch': 4, 'HIT@5': '0.001136', 'NDCG@5': '0.000550', 'HIT@10': '0.001317', 'NDCG@10': '0.000610', 'HIT@15': '0.001771', 'NDCG@15': '0.000732', 'HIT@20': '0.002271', 'NDCG@20': '0.000849'}
Validation score increased.  Saving model ...
  0%|                                                                                                                                                                                                       | 0/43 [00:10<?, ?it/s]
 35%|██████████████████████████████████████████████████████████████████▎                                                                                                                           | 15/43 [00:00<00:01, 23.62it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:01<00:00, 21.86it/s]
  0%|                                                                                                                                                                                                        | 0/1 [00:00<?, ?it/s]
Model Training
rec dataset length: 43
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:04<00:00,  4.88s/it]




 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                 | 39/43 [00:09<00:01,  3.87it/s]
{'epoch': 5, 'rec_avg_loss': '3.04512', 'joint_avg_loss': '0.000000', 'Align_loss': '0.000000', 'NMI_cluster_reassignment': '0.425896'}
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:10<00:00,  4.10it/s]
 63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                      | 27/43 [00:01<00:00, 22.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:02<00:00, 21.43it/s]
  0%|                                                                                                                                                                                                        | 0/1 [00:00<?, ?it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:04<00:00,  4.61s/it]




100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:08<00:00,  5.32it/s]
  0%|                                                                                                                                                                                                       | 0/43 [00:00<?, ?it/s]
{'Epoch': 5, 'HIT@5': '0.001226', 'NDCG@5': '0.000738', 'HIT@10': '0.001453', 'NDCG@10': '0.000814', 'HIT@15': '0.001681', 'NDCG@15': '0.000874', 'HIT@20': '0.001999', 'NDCG@20': '0.000950'}
Validation score increased.  Saving model ...
Model Training
rec dataset length: 43



 63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                      | 27/43 [00:06<00:03,  4.24it/s]
Traceback (most recent call last):
  File "main.py", line 269, in <module>
    main()
  File "main.py", line 234, in main
    trainer.train(epoch)
  File "/home/seongbeom/paper/preference_rec/trainers.py", line 99, in train
    self.iteration(epoch, self.train_dataloader, self.cluster_dataloader)
  File "/home/seongbeom/paper/preference_rec/trainers.py", line 444, in iteration
    rec_loss.backward()
  File "/home/seongbeom/anaconda3/envs/recsys/lib/python3.8/site-packages/torch/_tensor.py", line 522, in backward
    torch.autograd.backward(
  File "/home/seongbeom/anaconda3/envs/recsys/lib/python3.8/site-packages/torch/autograd/__init__.py", line 266, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt